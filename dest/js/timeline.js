define(["jquery"],function(a){function b(){this.cfg={}}return b.prototype={timeSlide:function(b){"use strict";function c(b){a("html, body").animate({scrollTop:b},500)}for(var d=(a.extend(this.cfg,b),function(a){return document.getElementById(a)}),e=function(){return document.body.offsetWidth},f=function(){return document.body.offsetHeight},g={},h=data.length-1;h>=0;h--){var i=new Date(data[h].date),j=i.getFullYear(),k=i.getMonth()+1,l=GetLunarDateString(i);g[j]||(g[j]={}),g[j][k]||(g[j][k]=[]);var m=data[h];m.lunar=l[0]+"<br>&nbsp;&nbsp;&nbsp;"+l[1],m.like_format=m.like<1e4?m.like:(m.like/1e4).toFixed(1)+"万",g[j][k].push(m)}var n=[],o=[],p=d("tpl_scrubber_year").innerHTML.replace(/^\s*/,"").replace(/\s*$/,""),q=d("tpl_scrubber_month").innerHTML.replace(/^\s*/,"").replace(/\s*$/,""),r=d("tpl_content_year").innerHTML.replace(/^\s*/,"").replace(/\s*$/,""),s=d("tpl_content_month").innerHTML.replace(/^\s*/,"").replace(/\s*$/,""),t=d("tpl_content_item").innerHTML.replace(/^\s*/,"").replace(/\s*$/,"");for(j in g){var u=[];for(k in g[j])u.unshift(q.replace(/\{month\}/g,k).replace(/\{year\}/g,j));n.unshift(p.replace(/\{year\}/g,j).replace(/\{list\}/g,u.join("")))}d("scrubber").innerHTML='<a href="javascript:;" class="now">现在</a>'+n.join("")+'<a href="javascript:;" class="birth">出生</a>';for(var j in g){var v=r.replace(/\{year\}/g,j),w=[];for(var k in g[j]){var x=[],y=!0;for(var h in g[j][k]){var z=g[j][k][h],A=t.replace(/\{date\}/g,z.date).replace(/\{lunar\}/g,z.lunar).replace(/\{intro\}/g,z.intro).replace(/\{media\}/g,z.media).replace(/\{like\}/g,z.like).replace(/\{leftOrRight\}/,h%2?"right":"left").replace(/\{isFirst\}/,y?"c_item_first":"").replace(/\{like_format\}/g,z.like_format).replace(/\{comment\}/g,z.comment);x.push(A),y=!1}w.unshift(s.replace(/\{year\}/g,j).replace(/\{month\}/g,k).replace(/\{list\}/g,x.join("")))}v=v.replace(/\{list\}/g,w.join("")),o.unshift(v)}d("content").innerHTML=o.join("")+'<div class="c_year" id="content_month_0_0">出生</div>';var B=function(a,b){for(var c=document.getElementsByClassName("s_year"),d=document.getElementsByClassName("s_month"),e=document.getElementsByClassName(a+"_month"),f=c.length-1;f>=0;f--)c[f].className="s_year";for(var f=d.length-1;f>=0;f--)d[f].style.display="none";for(var f=e.length-1;f>=0;f--)e[f].style.display="block";b.className="s_year cur"},C=function(a,b,c){for(var d=document.getElementsByClassName(a+"_month"),e=d.length-1;e>=0;e--)d[e].className=d[e].className.replace("cur","");c.className=c.className+" cur"},D=function(a){for(var b=d("content").getElementsByClassName("c_year"),c=[],e=0;e<b.length;e++)c.push(b[e].offsetTop);for(var e=1;e<c.length;e++)if(a>c[e-1]&&a<c[e]){var f=b[e-1].innerHTML;return void B(f,d("scrubber_year_"+f))}},E=function(a){for(var b=d("content").getElementsByClassName("c_month"),c=[],e=0;e<b.length;e++)c.push(b[e].offsetTop);for(var e=1;e<=c.length;e++){var f=b[e-1].id.split("_"),g=f[2],h=f[3];e==c.length&&a>c[e-1]?C(g,h,d("scrubber_month_"+g+h)):a>c[e-1]&&a<c[e]&&C(g,h,d("scrubber_month_"+g+h))}};a(".s_year").click(function(){var b=a(this);F(b.html(),this)});var F=function(b,d){B(b,d);var e=a("#content_year_"+b),f=e.offset().top;c(f)};a(".s_month").click(function(){var b=a(this).data("year"),c=a(this).data("month");G(b,c,this)});var G=function(b,d,e){C(b,d,e);var f=a("#content_month_"+b+"_"+d),g=f.offset().top;c(g)};a(".now").click(function(){c(0)}),a(".birth").click(function(){c(f())}),window.onscroll=function(){var a=document.body.scrollTop;a>200?(d("scrubber").style.position="fixed",d("scrubber").style.left=(e()-1080)/2+"px",d("scrubber").style.top="5rem"):(d("scrubber").style.position="",d("scrubber").style.left="",d("scrubber").style.top=""),D(a),E(a)},window.onresize=function(){window.onscroll()}}},{Timeline:b}});